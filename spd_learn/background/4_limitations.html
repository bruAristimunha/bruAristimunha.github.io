
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Limitations and When Not to Use SPD Approaches &#8212; SPD Learn 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=7073f910" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5aa371e9"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'background/4_limitations';</script>
    <link rel="canonical" href="https://spdlearn.github.io/spd_learn/background/4_limitations.html" />
    <link rel="icon" href="../_static/spd_learn.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Computational Methods for SPD Manifolds" href="5_computation_methods.html" />
    <link rel="prev" title="Different Types of Covariance and Computation Methods" href="3_different_types_of_covariance.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/spd_learn.png" class="logo__image only-light" alt="SPD Learn Logo"/>
    <img src="../_static/spd_learn.png" class="logo__image only-dark pst-js-only" alt="SPD Learn Logo"/>
  
  
    <p class="title logo__title"><strong>SPD</strong> Learn</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../theory.html">
    Theory
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../generated/auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq.html">
    FAQ
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="External Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/spd-learn/spd_learn" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/spd_learn/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../theory.html">
    Theory
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../generated/auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="External Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/spd-learn/spd_learn" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/spd_learn/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Background</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_spd_motivation.html">SPD Geometry: Motivation and Core Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_inherent_properties.html">Inherent Properties and Their Exploitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_different_types_of_covariance.html">Different Types of Covariance and Computation Methods</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Limitations and When Not to Use SPD Approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_computation_methods.html">Computational Methods for SPD Manifolds</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_deep_learning_integration.html">Deep Learning Integration: Autograd and Trivialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_spd_layers.html">SPD Neural Network Layers: A Complete Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_historical_context.html">Historical Context: SPD Methods in Neuroscience</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../geometric_concepts.html">Geometric Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numerical_stability.html">Numerical Stability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../theory.html" class="nav-link">Theory</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Background</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Limitations and When Not to Use SPD Approaches</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="limitations-and-when-not-to-use-spd-approaches">
<span id="limitations"></span><h1>Limitations and When Not to Use SPD Approaches<a class="headerlink" href="#limitations-and-when-not-to-use-spd-approaches" title="Link to this heading">#</a></h1>
<section id="understanding-the-limitations">
<h2>Understanding the Limitations<a class="headerlink" href="#understanding-the-limitations" title="Link to this heading">#</a></h2>
<p>While SPD geometry offers powerful tools for many machine learning applications, it’s important to
understand when these approaches are appropriate and when they may not be the best choice. This
section outlines key limitations and scenarios where alternative methods should be considered.</p>
</section>
<section id="computational-complexity">
<h2>Computational Complexity<a class="headerlink" href="#computational-complexity" title="Link to this heading">#</a></h2>
<section id="computational-cost">
<h3>Computational Cost<a class="headerlink" href="#computational-cost" title="Link to this heading">#</a></h3>
<p>Riemannian operations on SPD matrices typically require eigenvalue decomposition, which has
<span class="math notranslate nohighlight">\(O(n^3)\)</span> complexity for <span class="math notranslate nohighlight">\(n \times n\)</span> matrices. This can become prohibitive for:</p>
<ul class="simple">
<li><p><strong>High-dimensional problems</strong>: When <span class="math notranslate nohighlight">\(n &gt; 1000\)</span>, computational costs can be significant</p></li>
<li><p><strong>Real-time applications</strong>: Eigendecomposition may be too slow for online or streaming scenarios</p></li>
<li><p><strong>Large-scale datasets</strong>: Training on millions of SPD matrices can be computationally expensive</p></li>
</ul>
</section>
</section>
<section id="example-computational-trade-offs">
<h2>Example: Computational Trade-offs<a class="headerlink" href="#example-computational-trade-offs" title="Link to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">spd_learn.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">geodesic_distance_spdairm</span>

<span class="c1"># Small matrices: fast</span>
<span class="n">P1_small</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">P1_small</span> <span class="o">=</span> <span class="n">P1_small</span> <span class="o">@</span> <span class="n">P1_small</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">P2_small</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">P2_small</span> <span class="o">=</span> <span class="n">P2_small</span> <span class="o">@</span> <span class="n">P2_small</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">dist_small</span> <span class="o">=</span> <span class="n">geodesic_distance_spdairm</span><span class="p">(</span><span class="n">P1_small</span><span class="p">,</span> <span class="n">P2_small</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10x10 matrices: </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">ms&quot;</span><span class="p">)</span>

<span class="c1"># Large matrices: slower</span>
<span class="n">P1_large</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">P1_large</span> <span class="o">=</span> <span class="n">P1_large</span> <span class="o">@</span> <span class="n">P1_large</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="n">P2_large</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">P2_large</span> <span class="o">=</span> <span class="n">P2_large</span> <span class="o">@</span> <span class="n">P2_large</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">dist_large</span> <span class="o">=</span> <span class="n">geodesic_distance_spdairm</span><span class="p">(</span><span class="n">P1_large</span><span class="p">,</span> <span class="n">P2_large</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;500x500 matrices: </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">ms&quot;</span><span class="p">)</span>

<span class="c1"># Note: Consider Log-Euclidean approximations for large-scale problems</span>
</pre></div>
</div>
</section>
<section id="when-the-data-doesn-t-match-the-geometry">
<h2>When the Data Doesn’t Match the Geometry<a class="headerlink" href="#when-the-data-doesn-t-match-the-geometry" title="Link to this heading">#</a></h2>
<section id="not-all-symmetric-matrices-are-spd">
<h3>Not All Symmetric Matrices Are SPD<a class="headerlink" href="#not-all-symmetric-matrices-are-spd" title="Link to this heading">#</a></h3>
<p>Some applications produce symmetric matrices that are not positive definite:</p>
<ul class="simple">
<li><p><strong>Correlation matrices with missing data</strong>: May lose positive definiteness</p></li>
<li><p><strong>Regularized covariance estimates</strong>: Can become singular or near-singular</p></li>
<li><p><strong>Indefinite kernels</strong>: Some kernel functions produce indefinite matrices</p></li>
</ul>
<p>In these cases, you must either:</p>
<ol class="arabic simple">
<li><p><strong>Regularize</strong>: Add a small positive value to the diagonal (<span class="math notranslate nohighlight">\(\mathbf{P} + \epsilon \mathbf{I}\)</span>)</p></li>
<li><p><strong>Project</strong>: Use nearest SPD projection methods</p></li>
<li><p><strong>Choose another representation</strong>: Work in a different space entirely</p></li>
</ol>
</section>
</section>
<section id="example-regularization">
<h2>Example: Regularization<a class="headerlink" href="#example-regularization" title="Link to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_spd</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if matrix is SPD by verifying all eigenvalues are positive.&quot;&quot;&quot;</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">eigvals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>


<span class="c1"># A matrix that&#39;s symmetric but not positive definite</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is A SPD? </span><span class="si">{</span><span class="n">is_spd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># False due to small eigenvalues</span>

<span class="c1"># Regularize to ensure SPD</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-1</span>  <span class="c1"># Larger epsilon needed for this matrix</span>
<span class="n">A_reg</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is A_reg SPD? </span><span class="si">{</span><span class="n">is_spd</span><span class="p">(</span><span class="n">A_reg</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Should be True</span>
</pre></div>
</div>
</section>
<section id="first-order-statistics-may-be-sufficient">
<h2>First-Order Statistics May Be Sufficient<a class="headerlink" href="#first-order-statistics-may-be-sufficient" title="Link to this heading">#</a></h2>
<p>SPD matrices capture <strong>second-order statistics</strong> (covariances, correlations). However:</p>
<ul class="simple">
<li><p>If the data is well-captured by first-order statistics (means), SPD methods add unnecessary complexity</p></li>
<li><p>For simple classification tasks, Euclidean methods may perform equally well with less computation</p></li>
<li><p>When sample size is very small, Riemannian methods may overfit despite regularization</p></li>
</ul>
<p><strong>Rule of thumb</strong>: Consider SPD geometry when:</p>
<ul class="simple">
<li><p>Second-order relationships are meaningful (e.g., correlation structure matters)</p></li>
<li><p>You have sufficient samples to estimate covariance reliably</p></li>
<li><p>The geometric properties (invariance, etc.) provide tangible benefits</p></li>
</ul>
</section>
<section id="when-not-to-recommend-spd-approaches">
<h2>When Not to Recommend SPD Approaches<a class="headerlink" href="#when-not-to-recommend-spd-approaches" title="Link to this heading">#</a></h2>
<section id="low-dimensional-data">
<h3>Low-Dimensional Data<a class="headerlink" href="#low-dimensional-data" title="Link to this heading">#</a></h3>
<p>For data with very few features (<span class="math notranslate nohighlight">\(n &lt; 5\)</span>), the overhead of Riemannian operations may
outweigh benefits. Standard Euclidean methods are often sufficient.</p>
</section>
<section id="lack-of-covariance-structure">
<h3>Lack of Covariance Structure<a class="headerlink" href="#lack-of-covariance-structure" title="Link to this heading">#</a></h3>
<p>If your data doesn’t naturally form covariance or correlation matrices (e.g., you’re working with
images, text, or discrete labels), forcing an SPD representation is likely inappropriate.</p>
</section>
<section id="insufficient-samples">
<h3>Insufficient Samples<a class="headerlink" href="#insufficient-samples" title="Link to this heading">#</a></h3>
<p>Covariance estimation requires sufficient samples. With <span class="math notranslate nohighlight">\(N\)</span> samples and <span class="math notranslate nohighlight">\(n\)</span> features:</p>
<ul class="simple">
<li><p><strong>Rule of thumb</strong>: Need at least <span class="math notranslate nohighlight">\(N &gt; 2n\)</span> for stable covariance estimates</p></li>
<li><p>If <span class="math notranslate nohighlight">\(N &lt; n\)</span>, consider dimensionality reduction first or use shrinkage estimators</p></li>
</ul>
</section>
<section id="streaming-or-online-learning">
<h3>Streaming or Online Learning<a class="headerlink" href="#streaming-or-online-learning" title="Link to this heading">#</a></h3>
<p>While incremental algorithms exist, most Riemannian methods are designed for batch processing.
For truly online scenarios, consider:</p>
<ul class="simple">
<li><p><strong>Approximations</strong>: Log-Euclidean metrics are faster</p></li>
<li><p><strong>Euclidean methods</strong>: May be more practical for real-time constraints</p></li>
<li><p><strong>Specialized algorithms</strong>: Some streaming SPD methods exist but are less mature</p></li>
</ul>
</section>
</section>
<section id="alternative-approaches">
<h2>Alternative Approaches<a class="headerlink" href="#alternative-approaches" title="Link to this heading">#</a></h2>
<p>When SPD geometry isn’t suitable, consider:</p>
<ol class="arabic simple">
<li><p><strong>Log-Euclidean Metric</strong>: Faster approximation that works in the matrix logarithm space</p></li>
<li><p><strong>Tangent Space Methods</strong>: Project to tangent space and use Euclidean methods</p></li>
<li><p><strong>Standard Deep Learning</strong>: For tasks where geometric structure isn’t critical</p></li>
<li><p><strong>Other Manifolds</strong>: Hyperbolic spaces, Grassmann manifolds, etc., depending on data structure</p></li>
</ol>
</section>
<section id="example-log-euclidean-alternative">
<h2>Example: Log-Euclidean Alternative<a class="headerlink" href="#example-log-euclidean-alternative" title="Link to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">spd_learn.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">geodesic_distance_spdairm</span><span class="p">,</span> <span class="n">log_euclidean_distance</span>

<span class="n">P1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]])</span>
<span class="n">P2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>

<span class="c1"># Affine-invariant distance (exact but slower)</span>
<span class="n">dist_riemann</span> <span class="o">=</span> <span class="n">geodesic_distance_spdairm</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>

<span class="c1"># Log-Euclidean distance (approximate but faster)</span>
<span class="n">dist_logeuc</span> <span class="o">=</span> <span class="n">log_euclidean_distance</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Riemannian distance: </span><span class="si">{</span><span class="n">dist_riemann</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Log-Euclidean distance: </span><span class="si">{</span><span class="n">dist_logeuc</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">dist_riemann</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dist_logeuc</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="key-takeaways">
<h2>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>SPD methods have <span class="math notranslate nohighlight">\(O(n^3)\)</span> computational complexity due to eigendecomposition</p></li>
<li><p>Not suitable for very high-dimensional spaces without approximations</p></li>
<li><p>Requires data to naturally form valid SPD matrices</p></li>
<li><p>Needs sufficient samples for covariance estimation</p></li>
<li><p>Consider alternatives (Log-Euclidean, tangent space) for computational efficiency</p></li>
<li><p>Always validate that the geometric structure matches your data and problem</p></li>
</ul>
<p>In the next section, we’ll explore how to integrate SPD geometry into deep learning frameworks
while addressing some of these computational challenges.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<span class="target" id="id1"></span></section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3_different_types_of_covariance.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Different Types of Covariance and Computation Methods</p>
      </div>
    </a>
    <a class="right-next"
       href="5_computation_methods.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Computational Methods for SPD Manifolds</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2026, SPD Learn Developers.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>